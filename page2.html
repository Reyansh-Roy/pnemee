<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Project Nemesis: Psychological Fingerprinting â€“ Question 1</title>
  <meta name="viewport" content="width=1024, user-scalable=no">
  <link href="https://fonts.googleapis.com/css?family=IBM+Plex+Mono:700|Oswald:700&display=swap" rel="stylesheet">
  <style>
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      background: linear-gradient(135deg, #060b15 0%, #1a2438 100%);
      color: #e8eefa;
      font-family: 'IBM Plex Mono', 'Oswald', 'Consolas', monospace;
      letter-spacing: 0.01em;
      overflow: hidden;
      scrollbar-width: none;
      -ms-overflow-style: none;
    }
    body::-webkit-scrollbar { display: none; }
    #denied {
      position: fixed;
      inset: 0;
      background: #070c1bee;
      z-index: 9999;
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: Oswald, sans-serif;
      font-size: 2.3rem;
      color: #fa3232;
      letter-spacing: 0.1em;
      text-align: center;
      backdrop-filter: blur(3px);
      pointer-events: all;
    }
    .nemesis-container {
      width: 100vw;
      height: 100vh;
      display: flex;
      flex-direction: row;
      min-width: 900px;
      position: relative;
      z-index: 1;
      background: linear-gradient(120deg, #0c111a 0%, #101933 100%);
    }
    .left-panel {
      width: 60vw;
      min-width: 460px;
      height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      position: relative;
      background: linear-gradient(120deg,#070b15 50%,#161c28 100%);
      overflow: hidden;
      z-index: 2;
      box-shadow: 1px 0 18px #101c2f88;
    }
    .ai-silhouette {
      width: 185px;
      filter: blur(1.6px) drop-shadow(0 0 20px #33f9ff50) grayscale(1) brightness(0.68) contrast(1.13);
      opacity: 0.98;
      border-radius: 40% 45% 42% 44% / 50% 60% 58% 56%;
      box-shadow: 0 0 50px 0 #1722d4cc, 0 0 120px #1ef8ff2a;
      margin-bottom: 2.2rem;
      animation: silhouettePulse 2.5s infinite alternate;
      transition: filter 0.3s;
    }
    @keyframes silhouettePulse {
      0% { filter: blur(2.2px) brightness(0.73) drop-shadow(0 0 16px #12e7f8); }
      100% { filter: blur(1px) brightness(0.95) drop-shadow(0 0 38px #30e7f8); }
    }
    .question-header {
      display: flex;
      align-items: center;
      gap: 0.7em;
      margin-bottom: 0.8em;
      margin-top: 0.6em;
      width: 100%;
      max-width: 480px;
      font-family: Oswald, 'IBM Plex Mono', monospace;
      font-size: 1.56rem;
      letter-spacing: 0.08em;
      color: #e9eaff;
      text-shadow: 0 0 8px #28e5e866, 0 0 2px #e01b4f44;
      font-weight: bold;
    }
    .neural-icon {
      width: 2.2em; height: 2.2em;
      filter: drop-shadow(0 0 4px #13e2ffbb);
    }
    .question-text {
      font-family: 'IBM Plex Mono', monospace;
      font-size: 1.2rem;
      letter-spacing: 0.02em;
      color: #b1ecff;
      text-shadow: 0 0 8px #229aff66;
      margin-bottom: 1.5rem;
      width: 100%;
      max-width: 420px;
      font-weight: 600;
    }
    .ghost-input-wrap {
      width: 100%;
      max-width: 460px;
      margin-bottom: 1.0em;
      position: relative;
    }
    .ghost-input {
      width: 100%;
      min-height: 90px;
      max-height: 210px;
      padding: 1em 1.1em 1.3em 1.1em;
      font-size: 1.14rem;
      font-family: 'IBM Plex Mono', monospace;
      background: linear-gradient(120deg, #141a24 70%, #25316a 110%);
      color: #e1f5ff;
      border: 2px solid #2af7e7cc;
      border-radius: 13px;
      outline: none;
      resize: vertical;
      box-shadow: 0 0 14px #1be9f622;
      transition: border 0.18s, box-shadow 0.24s;
      z-index: 2;
      caret-color: #25ffe9;
      line-height: 1.46;
      letter-spacing: 0.01em;
      white-space: pre-line;
      overflow-y: auto;
      animation: inputAppear 1.0s;
    }
    @keyframes inputAppear { from {opacity:0;} to {opacity:1;} }
    .ghost-input:focus {
      border: 2.5px solid #ff5999;
      box-shadow: 0 0 18px #e0199e44;
      background: linear-gradient(120deg, #182334 70%, #371a34 130%);
      color: #fff;
      caret-color: #ff23a5;
    }
    .ghost-text {
      position: absolute;
      top: 1.1em;
      left: 1.2em;
      font-size: 1.13rem;
      color: #6fa3a7;
      opacity: 0.92;
      pointer-events: none;
      z-index: 3;
      font-style: italic;
      transition: opacity 0.28s;
      font-family: 'IBM Plex Mono', monospace;
      white-space: pre-line;
      text-shadow: 0 0 2px #28e5e833;
      animation: ghostType 1.2s steps(25);
    }
    @keyframes ghostType {
      from { width: 0; opacity:0.6;}
      to { width: 100%; opacity:0.96;}
    }
    .subtext {
      font-size: 0.99rem;
      color: #a6cfdc;
      margin-top: 0.7em;
      margin-bottom: 1.0em;
      text-align: left;
      width: 100%;
      max-width: 420px;
      text-shadow: 0 0 3px #09e5ee44;
    }
    .finished-btn {
      width: 120px;
      padding: 0.75em 1em;
      margin-top: 0.4em;
      font-size: 1.08rem;
      font-family: 'IBM Plex Mono', monospace;
      background: linear-gradient(90deg, #24f6 10%, #1aeed9 90%);
      border: none;
      border-radius: 50px;
      color: #0e1a22;
      font-weight: bold;
      letter-spacing: 0.07em;
      box-shadow: 0 0 12px #18f9ee44;
      cursor: pointer;
      transition: background 0.19s, box-shadow 0.17s, color 0.13s;
      outline: none;
      position: relative;
      z-index: 5;
      text-shadow: 0 1px 7px #fff3;
      filter: drop-shadow(0 0 6px #25e6fa77);
    }
    .finished-btn:hover, .finished-btn:focus {
      background: linear-gradient(90deg,#ff5f99 5%,#1aeed9 85%);
      box-shadow: 0 0 18px #ff599988;
      color: #fff;
      outline: none;
    }
    .processing-vulnerability {
      display: flex;
      align-items: center;
      justify-content: left;
      gap: 0.7em;
      font-size: 1.15rem;
      color: #eaeaea;
      margin-top: 1.6em;
      width: 100%;
      max-width: 420px;
      min-height: 32px;
      font-family: 'IBM Plex Mono', monospace;
      letter-spacing: 0.03em;
      text-shadow: 0 0 6px #27eeff33;
      animation: fadeIn 0.8s;
    }
    .spinner {
      width: 27px;
      height: 27px;
      border: 4px solid #1ef8ff33;
      border-top: 4px solid #ff23a5cc;
      border-radius: 50%;
      animation: spin 1.1s linear infinite;
      margin-right: 0.7em;
      filter: drop-shadow(0 0 7px #25e6fa44);
    }
    @keyframes spin {
      0% { transform: rotate(0deg);}
      100% { transform: rotate(360deg);}
    }
    @keyframes fadeIn { from {opacity:0;} to {opacity:1;} }
    .core-vulnerability {
      margin-top: 1.8em;
      font-size: 1.18rem;
      color: #ff92be;
      font-family: 'IBM Plex Mono', monospace;
      font-weight: 700;
      text-shadow: 0 0 12px #28e5e8bb, 0 0 1px #ff2777;
      letter-spacing: 0.04em;
      animation: vulnReveal 1.3s cubic-bezier(0.38,0.77,0.68,1.4);
      min-height: 38px;
      transition: color 0.4s;
      opacity: 0;
      pointer-events: none;
    }
    @keyframes vulnReveal { 0% {opacity:0;letter-spacing:0.6em;} 90% {opacity:1;} 100% {opacity:1;} }
    .core-vulnerability.show { opacity: 1; pointer-events: auto;}
    .continue-btn {
      width: 130px;
      padding: 0.82em 1em;
      margin-top: 2.2em;
      font-size: 1.1rem;
      font-family: 'IBM Plex Mono', monospace;
      background: linear-gradient(90deg,#141f49,#4ee6f3 70%);
      border: none;
      border-radius: 30px;
      color: #fff;
      font-weight: bold;
      letter-spacing: 0.09em;
      box-shadow: 0 0 13px #1be9f622;
      cursor: pointer;
      transition: background 0.15s, box-shadow 0.13s;
      outline: none;
      filter: drop-shadow(0 0 6px #21e0ff77);
      text-shadow: 0 1px 7px #fff3;
      display: none;
    }
    .continue-btn:hover, .continue-btn:focus {
      background: linear-gradient(90deg,#ff5999 5%,#2df2e6 85%);
      box-shadow: 0 0 16px #ff599988;
      color: #fff;
      outline: none;
    }
    /* Right panel - timer, neural effects */
    .right-panel {
      width: 40vw;
      min-width: 300px;
      height: 100vh;
      background: radial-gradient(circle at 60% 40%,#11244c 16%, #151933 80%);
      display: flex;
      align-items: flex-start;
      justify-content: flex-end;
      position: relative;
      box-shadow: -2px 0 18px #222d4477;
      z-index: 1;
    }
    .timer-box {
      position: absolute;
      top: 28px; right: 44px;
      background: linear-gradient(90deg, #152a44cc 0%, #233b66ee 100%);
      color: #fff;
      padding: 0.7em 1.8em 0.7em 1.5em;
      border-radius: 15px;
      font-family: 'IBM Plex Mono', monospace;
      font-size: 1.42rem;
      letter-spacing: 0.16em;
      font-weight: bold;
      box-shadow: 0 0 13px #1be9f622;
      border: 1.2px solid #3976b0aa;
      z-index: 10;
      user-select: none;
      animation: fadeIn 0.8s;
      text-shadow: 0 0 8px #28e5e866;
      display: flex;
      align-items: center;
      gap: 0.7em;
    }
    .timer-anim {
      width: 23px;
      height: 23px;
      margin-bottom: -2px;
      animation: timerPulse 2s infinite alternate;
    }
    @keyframes timerPulse {
      0% { filter: drop-shadow(0 0 6px #21e0ff); }
      80% { filter: drop-shadow(0 0 19px #19ffd6); }
      100% { filter: drop-shadow(0 0 7px #f6ff1a); }
    }
    /* Responsive (min-width 900px) */
    @media (max-width: 900px) {
      .nemesis-container { display: none !important; }
      #denied { display: flex !important; }
    }
    @media (max-width: 1200px) {
      .left-panel { min-width: 300px; }
      .right-panel { min-width: 120px;}
      .ghost-input-wrap, .ghost-input, .overlay-content { min-width: 260px;}
    }
  </style>
</head>
<body>
<div id="denied" style="display:none;">Access Denied â€“ Desktop/Tablet Only</div>
<div class="nemesis-container">
  <div class="left-panel">
    <img class="ai-silhouette" id="silhouette" src="user_silhouette.png" alt="AI Subject">
    <div class="question-header">
      <svg class="neural-icon" viewBox="0 0 36 36"><circle cx="18" cy="18" r="17" fill="none" stroke="#1aeed9" stroke-width="2"/><ellipse cx="24" cy="13" rx="5" ry="3.3" fill="none" stroke="#ff5f99" stroke-width="2"/><ellipse cx="13" cy="20.5" rx="6.2" ry="4" fill="none" stroke="#3af7f9" stroke-width="2"/><ellipse cx="18" cy="18" rx="12" ry="7.5" fill="none" stroke="#1aeed9" stroke-width="2"/><circle cx="22" cy="12" r="1.1" fill="#ff5f99"/><circle cx="27" cy="13" r="0.75" fill="#ff5f99"/><circle cx="14.5" cy="21" r="1.1" fill="#3af7f9"/></svg>
      Question 1:
    </div>
    <div class="question-text">Whatâ€™s the worst thing someone could say about you publicly?</div>
    <div class="ghost-input-wrap">
      <textarea class="ghost-input" id="ghostInput" maxlength="360" spellcheck="false" rows="3"></textarea>
      <div class="ghost-text" id="ghostText"></div>
    </div>
    <div class="subtext">Your answer shapes your adversary.</div>
    <button class="finished-btn" id="finishedBtn">Finished</button>
    <div class="processing-vulnerability" id="processingVuln" style="display:none;">
      <div class="spinner"></div>
      Processing Core Vulnerability...
    </div>
    <div class="core-vulnerability" id="coreVuln"></div>
    <button class="continue-btn" id="continueBtn" style="display:none;">Continue</button>
  </div>
  <div class="right-panel">
    <div class="timer-box" id="timerBox">
      <svg class="timer-anim" viewBox="0 0 28 28"><circle cx="14" cy="14" r="12" fill="none" stroke="#ff5f99" stroke-width="3" opacity="0.3"/><path d="M14 5v9l6 2" stroke="#1aeed9" stroke-width="2" fill="none"/></svg>
      <span id="timerText"></span>
    </div>
  </div>
</div>
<script>
/* ---- MOBILE/SCREEN CHECK ---- */
function isMobile() {
  return (window.innerWidth < 900 ||
    /Mobi|Android|iPhone|iPad|iPod|Opera Mini|IEMobile|Mobile/i.test(navigator.userAgent));
}
function showDenied() {
  document.getElementById('denied').style.display = 'flex';
  document.querySelector('.nemesis-container')?.remove();
  document.body.style.overflow = 'hidden';
}
if (isMobile()) showDenied();
window.addEventListener('resize', function() { if (isMobile()) showDenied(); });

/* ---- TIMER LOGIC ---- */
const TIMER_TOTAL = 7 * 60; // 7 min for all questions
const TIMER_KEY = 'nemesis_total_timer';
let timer = TIMER_TOTAL, timerInterval, timerPaused = false, timerStart;

function setTimerText(s) {
  document.getElementById('timerText').textContent =
    String(Math.floor(s/60)).padStart(2,'0') + ':' + String(s%60).padStart(2,'0');
}
function saveTimerState() {
  sessionStorage.setItem(TIMER_KEY, JSON.stringify({time: timer, started: timerStart || Date.now()}));
}
function loadTimerState() {
  let t = sessionStorage.getItem(TIMER_KEY);
  if (t) {
    let obj = JSON.parse(t);
    timer = obj.time;
    timerStart = obj.started;
  } else {
    timer = TIMER_TOTAL;
    timerStart = Date.now();
  }
  setTimerText(timer);
}
function startTimer() {
  setTimerText(timer);
  timerInterval = setInterval(() => {
    if (!timerPaused && timer > 0) {
      timer--;
      setTimerText(timer);
      saveTimerState();
    }
    if (timer <= 0) {
      clearInterval(timerInterval);
      setTimerText(0);
      // Optional: handle end-of-time
    }
  }, 1000);
}
function pauseTimer() { timerPaused = true; }
function resumeTimer() { timerPaused = false; }
loadTimerState();
startTimer();

/* ---- GHOST INPUT LOGIC ---- */
const ghostLines = [
  `"Heâ€™s just a brand, not a builder."`,
  `"Everything he made was hype â€” no substance."`
];
const ghostText = ghostLines.join('\n');
const input = document.getElementById('ghostInput');
const ghostDiv = document.getElementById('ghostText');
let ghostTimeout, ghostActive = false;
function typeGhostText() {
  ghostDiv.textContent = '';
  let i = 0;
  ghostActive = true;
  function step() {
    if (i <= ghostText.length) {
      ghostDiv.textContent = ghostText.slice(0, i);
      i++;
      ghostTimeout = setTimeout(step, 16 + Math.random()*40);
    } else {
      ghostActive = false;
    }
  }
  step();
}
typeGhostText();
input.value = '';
input.addEventListener('focus', () => {
  ghostDiv.style.opacity = 0;
  clearTimeout(ghostTimeout);
});
input.addEventListener('blur', () => {
  if (!input.value) {
    ghostDiv.style.opacity = 1;
    typeGhostText();
  }
});
input.addEventListener('input', () => {
  if (!input.value) {
    ghostDiv.style.opacity = 1;
    if (!ghostActive) typeGhostText();
  } else {
    ghostDiv.style.opacity = 0;
    clearTimeout(ghostTimeout);
  }
});

/* ---- SUBMIT AND PROCESSING LOGIC ---- */
const finishedBtn = document.getElementById('finishedBtn');
const processingDiv = document.getElementById('processingVuln');
const coreVulnDiv = document.getElementById('coreVuln');
const continueBtn = document.getElementById('continueBtn');
let startTime = Date.now();

finishedBtn.addEventListener('click', async () => {
  let answer = input.value.trim();
  if (!answer) {
    input.focus();
    ghostDiv.style.opacity = 1;
    return;
  }
  // Lock UI
  input.disabled = true;
  finishedBtn.disabled = true;
  finishedBtn.style.opacity = 0.7;
  pauseTimer();
  processingDiv.style.display = 'flex';
  coreVulnDiv.style.display = 'none';
  continueBtn.style.display = 'none';

  // Simulate AI processing (random delay)
  let aiDelay = 1800 + Math.random()*4200;
  await new Promise(r=>setTimeout(r, aiDelay));

  // ---- GEMINI API INTEGRATION PLACEHOLDER ----
  // Replace this section with your Gemini 2.0 Flash call
  // Example (pseudo):
  // const coreVulnerability = await getGeminiVulnerability(answer);
  // For demo, we simulate with static/heuristic result:
  let coreVulnerability = fakeVulnerability(answer);
  // ---- END PLACEHOLDER ----

  // Show result with animation
  processingDiv.style.display = 'none';
  coreVulnDiv.innerHTML = `<span style="color:#ffb7e3;">&rarr; Core Vulnerability:</span> ${coreVulnerability}`;
  coreVulnDiv.classList.add('show');
  setTimeout(() => {
    continueBtn.style.display = 'inline-block';
  }, 900);

  // Save report
  saveReport(answer, coreVulnerability, Math.round((Date.now()-startTime)/1000));
});

function fakeVulnerability(text) {
  // Heuristic for demo only; replace with Gemini result
  text = text.toLowerCase();
  if (text.includes('fraud') || text.includes('phony') || text.includes('overrated') || text.includes('poser'))
    return 'Reputation Fragility';
  if (text.includes('weak') || text.includes('failure') || text.includes('useless') || text.includes('incompetent'))
    return 'Fear of Inadequacy';
  if (text.includes('alone') || text.includes('ignored') || text.includes('irrelevant'))
    return 'Fear of Irrelevance';
  if (text.length < 18) return 'Defensive Minimalism';
  return 'Reputation Fragility';
}
function saveReport(answer, coreVuln, timeTaken) {
  // Save per-question
  let report = JSON.parse(localStorage.getItem('nemesis_report')||'{}');
  report['q1'] = {
    answer, coreVuln, timeTaken,
    timestamp: Date.now()
  };
  localStorage.setItem('nemesis_report', JSON.stringify(report));
}
/* Continue to next question */
continueBtn.addEventListener('click', ()=>{
  resumeTimer();
  // (Optional: Save timer state here again if needed)
  window.location.href = 'page3.html';
});

/* ---- SECURITY RESTRICTIONS ---- */
// Block copy, cut, paste, print, context menu, select, devtools, drag, etc
document.addEventListener('contextmenu', e => e.preventDefault());
document.addEventListener('copy', e => { e.preventDefault(); return false; });
document.addEventListener('cut', e => { e.preventDefault(); return false; });
document.addEventListener('paste', e => { e.preventDefault(); return false; });
document.addEventListener('selectstart', e => e.preventDefault());
document.addEventListener('keydown', e => {
  if (
    e.key === 'F12' || e.key === 'PrintScreen' || e.key === 'Meta' ||
    ((e.ctrlKey || e.metaKey) && ['s','p','c','u','i','a','x','v','S','P','C','U','I','A','X','V'].includes(e.key))
  ) { e.preventDefault(); e.stopPropagation(); return false;}
  if (
    (e.ctrlKey && e.shiftKey && ['I','J','C','U'].includes(e.key.toUpperCase())) ||
    (e.metaKey && e.altKey && ['I','J','C','U'].includes(e.key.toUpperCase()))
  ) { e.preventDefault(); return false;}
});
document.addEventListener('dragstart', e => e.preventDefault());
document.addEventListener('drop', e => e.preventDefault());
window.addEventListener('blur', () => { window.focus(); });
window.addEventListener('beforeunload', e => {
  e.preventDefault(); e.returnValue = ''; return '';
});
window.onscroll = () => window.scrollTo(0,0);

/* ---- DEVELOPER: SWAP SILHOUETTE ---- */
/* Just change the src attribute on <img id="silhouette"> to any PNG/JPG as needed. */

</script>
</body>
</html>
