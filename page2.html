<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Project Nemesis: Initiation Protocol – Psychological Fingerprinting</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary-black: #101217;
      --accent-red: #ff2424;
      --accent-red-glow: #a30000;
      --alert-blue: #76c5fa;
      --highlight-white: #e3ecfa;
      --bubble-red: #ff4343;
      --bubble-blue: #7dd7ff;
      --bubble-white: #fafbfc;
      --vuln-bg: rgba(20,10,14,0.88);
      --scanline-color: rgba(210, 225, 255, 0.015);
      --circuit-color: rgba(120,200,255,0.035);
      --shadow: 0 0 24px 6px #010203f2;
    }

    html, body {
      background: var(--primary-black);
      margin: 0;
      padding: 0;
      width: 100vw;
      height: 100vh;
      min-height: 100vh;
      font-family: 'JetBrains Mono', 'IBM Plex Mono', 'Fira Mono', 'Consolas', 'monospace';
      overflow: hidden;
      box-sizing: border-box;
    }

    body {
      position: relative;
      width: 100vw;
      height: 100vh;
      overflow: hidden;
      /* grid to center content vertically */
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      align-items: stretch;
    }

    /* Background scanlines */
    .scanlines {
      pointer-events: none;
      position: fixed;
      left: 0; top: 0; width: 100vw; height: 100vh; z-index: 1;
      background-image: repeating-linear-gradient(
        to bottom,
        var(--scanline-color) 0px,
        var(--scanline-color) 2px,
        transparent 2.5px,
        transparent 7px
      );
      mix-blend-mode: screen;
    }
    /* Neural circuits */
    .circuits {
      pointer-events: none;
      position: fixed;
      left: 0; top: 0; width: 100vw; height: 100vh; z-index: 2;
      background-image: 
        repeating-radial-gradient(circle at 30% 40%, var(--circuit-color) 1px, transparent 8px),
        repeating-radial-gradient(circle at 60% 65%, var(--circuit-color) 2px, transparent 12px);
      opacity: 0.95;
      mix-blend-mode: lighten;
    }

    /* Header + Timer */
    .header-row {
      width: 100vw;
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      padding: 34px 5vw 0 5vw;
      position: relative;
      z-index: 10;
    }
    .header-title {
      color: var(--alert-blue);
      font-size: 1.65rem;
      font-weight: 700;
      letter-spacing: 0.05em;
      text-shadow: 0 0 4px #14315e, 0 0 2px #162344;
      user-select: none;
    }
    .session-timer {
      color: var(--accent-red);
      font-size: 1.13rem;
      font-family: 'JetBrains Mono', 'IBM Plex Mono', monospace;
      letter-spacing: 0.13em;
      font-weight: 600;
      text-shadow: 0 0 8px #2a1a1a99;
      user-select: none;
    }

    /* Main question */
    .main-question {
      margin: 52px auto 0 auto;
      text-align: center;
      color: var(--highlight-white);
      font-size: 2.07rem;
      font-weight: 600;
      text-shadow: 0 0 18px #68e4fe3b, 0 0 3px #0d263c7a;
      letter-spacing: 0.01em;
      z-index: 15;
      position: relative;
      width: 100%;
      max-width: 1100px;
      transition: color 0.22s;
      filter: drop-shadow(0 0 8px #2058fa42);
    }

    /* Silhouette */
    .silhouette-container {
      position: absolute;
      left: 0; top: 0; width: 100vw; height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 5;
      pointer-events: none;
      overflow: visible;
      /* For fade in animation */
      opacity: 0;
      animation: silhouette-fade-in 1.1s 0.6s forwards;
    }
    @keyframes silhouette-fade-in {
      to { opacity: 1; }
    }
    .silhouette-img {
      display: block;
      margin: 0 auto;
      width: 32vw;
      max-width: 440px;
      min-width: 260px;
      opacity: 0.58;
      filter: brightness(0.97) grayscale(80%) drop-shadow(0 0 44px #162c4e);
      z-index: 7;
      transition: opacity 0.4s;
    }

    /* Ghost bubbles (right only) */
    .bubble-word {
      position: absolute;
      right: 10vw;
      color: var(--bubble-white);
      font-size: 1.35rem;
      font-family: inherit;
      font-weight: 600;
      opacity: 0.16;
      pointer-events: none;
      text-shadow: 0 0 18px #fff3, 0 0 4px #c2d8e1bb;
      animation: bubble-flicker 4s infinite alternate;
      filter: blur(0.1px);
      user-select: none;
      z-index: 15;
    }
    .bubble-word.red { color: var(--bubble-red); opacity: 0.22;}
    .bubble-word.blue { color: var(--bubble-blue); opacity: 0.18;}
    /* Flicker for text bubbles */
    @keyframes bubble-flicker {
      0% { opacity: 0.19; filter: blur(0.1px);}
      16% { opacity: 0.33; filter: blur(0.3px);}
      38% { opacity: 0.11; filter: blur(0.2px);}
      70% { opacity: 0.24; filter: blur(0.06px);}
      100% { opacity: 0.16; filter: blur(0.13px);}
    }

    /* Input glass box */
    .ghost-input-container {
      position: relative;
      width: 620px;
      max-width: 72vw;
      margin: 0 auto;
      z-index: 15;
      margin-top: 38px;
      transition: box-shadow 0.2s;
    }
    .ghost-input {
      width: 100%;
      font-size: 1.28rem;
      font-family: inherit;
      line-height: 1.6;
      color: #bfe4ff;
      background: rgba(25, 32, 40, 0.42);
      border: 1.7px solid #66b2fa33;
      border-radius: 13px;
      box-shadow: 0 4px 40px #19233c33, 0 0 0 2px #5ec2ff19;
      padding: 25px 22px 23px 22px;
      resize: none;
      outline: none;
      transition: border 0.18s, box-shadow 0.18s, background 0.24s;
      backdrop-filter: blur(5.7px) brightness(1.05);
      text-shadow: 0 0 7px #87e8ff18;
      min-height: 84px;
      max-height: 240px;
      overflow-y: auto;
      letter-spacing: 0.01em;
      caret-color: var(--accent-red);
      animation: input-fadein 1.3s cubic-bezier(.71,.11,.58,1.04);
    }
    @keyframes input-fadein {
      0% { opacity: 0; transform: translateY(24px);}
      100% { opacity: 1; transform: translateY(0);}
    }
    .ghost-input:focus {
      border-color: var(--alert-blue);
      background: rgba(44, 58, 82, 0.49);
      box-shadow: 0 0 0 2px var(--alert-blue), 0 8px 60px #54d8ff18;
    }
    /* Input shiver on hover */
    .ghost-input-container:hover .ghost-input,
    .ghost-input-container:focus-within .ghost-input {
      animation: shiver 0.45s linear;
    }
    @keyframes shiver {
      0% { transform: translateX(0px);}
      22% { transform: translateX(-1.6px);}
      39% { transform: translateX(2px);}
      60% { transform: translateX(-1.1px);}
      80% { transform: translateX(0.7px);}
      100% { transform: translateX(0);}
    }

    /* Ghost typing cursor animation */
    .ghost-cursor {
      display: inline-block;
      width: 11px;
      height: 1.18em;
      vertical-align: bottom;
      background: linear-gradient(90deg, var(--alert-blue), var(--accent-red));
      margin-left: 2px;
      border-radius: 2px;
      animation: ghost-cursor-blink 0.7s steps(2, jump-none) infinite;
      opacity: 0.74;
      box-shadow: 0 0 9px 2px #fff9;
    }
    @keyframes ghost-cursor-blink {
      0%, 45% { opacity: 1;}
      50%, 100% { opacity: 0.2;}
    }

    /* SUBMIT button */
    .submit-btn {
      width: 420px;
      max-width: 80vw;
      margin: 33px auto 0 auto;
      display: block;
      font-size: 1.34rem;
      font-family: inherit;
      padding: 18px 0 15px 0;
      background: none;
      border: 2.6px solid var(--accent-red);
      border-radius: 14px;
      color: var(--accent-red);
      font-weight: 700;
      letter-spacing: 0.09em;
      cursor: pointer;
      text-shadow: 0 0 18px #ff2222, 0 0 4px #ff555533;
      box-shadow: 0 0 16px 1px #b213139f;
      outline: none;
      position: relative;
      z-index: 15;
      transition: color 0.19s, border-color 0.15s, box-shadow 0.16s, background 0.18s;
      animation: btn-fadein 1.2s 0.19s cubic-bezier(.66,.07,.58,1.02);
    }
    .submit-btn:disabled {
      color: #a82a33 !important;
      border-color: #502828 !important;
      cursor: not-allowed;
      background: #140c12;
      opacity: 0.73;
      text-shadow: none;
      box-shadow: none;
    }
    .submit-btn:hover, .submit-btn:focus {
      border-color: #f12240;
      color: #fff;
      background: linear-gradient(90deg, #26020799 15%, #47000060 100%);
      animation: shiver 0.41s linear;
      box-shadow: 0 0 24px 4px #ff1b3c7a;
      outline: none;
    }
    @keyframes btn-fadein {
      0% { opacity: 0; transform: translateY(20px);}
      100% { opacity: 1; transform: translateY(0);}
    }

    /* Nemesis analysis overlay (during/after submit) */
    .analysis-overlay {
      position: fixed;
      left: 0; bottom: 0; width: 100vw; height: 190px;
      z-index: 40;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-end;
      pointer-events: none;
      opacity: 0;
      animation: analysis-fade-in 0.81s cubic-bezier(.66,.05,.39,.99) forwards;
    }
    @keyframes analysis-fade-in {
      from { opacity: 0;}
      to { opacity: 1;}
    }
    .analysis-text {
      color: var(--accent-red);
      font-size: 1.25rem;
      font-weight: 600;
      text-align: center;
      letter-spacing: 0.03em;
      text-shadow: 0 0 18px #f01821, 0 0 8px #e4486a35;
      margin-bottom: 19px;
      background: none;
      animation: analysis-pulse 2s infinite;
      user-select: none;
      font-family: inherit;
      filter: drop-shadow(0 0 10px #a21419a9);
    }
    @keyframes analysis-pulse {
      0% { filter: drop-shadow(0 0 2px #a21419a9);}
      51% { filter: drop-shadow(0 0 24px #a21419e5);}
      100% { filter: drop-shadow(0 0 2px #a21419a9);}
    }
    .core-vuln-box {
      margin-top: 8px;
      padding: 14px 39px 13px 39px;
      background: rgba(30, 10, 17, 0.96);
      color: var(--accent-red);
      font-size: 1.21rem;
      font-family: inherit;
      font-weight: 800;
      border: 2.7px solid #791e2e88;
      border-radius: 13px;
      letter-spacing: 0.09em;
      text-shadow: 0 0 8px #7f2121b3;
      box-shadow: 0 0 12px 1px #8f1919b2;
      opacity: 1;
      display: inline-block;
      animation: vuln-slidein 0.97s 0.6s cubic-bezier(.43,.41,.14,1.29) forwards;
      transform: translateY(100px);
      user-select: none;
    }
    @keyframes vuln-slidein {
      0% { transform: translateY(80px) scale(0.93); opacity: 0;}
      50% { opacity: 0.21;}
      100% { transform: translateY(0) scale(1); opacity: 1;}
    }

    /* Next Truth button */
    .next-btn {
      position: fixed;
      bottom: 33px;
      right: 8vw;
      font-size: 1.09rem;
      font-family: inherit;
      font-weight: 600;
      padding: 15px 32px 13px 32px;
      border: 2.6px solid var(--alert-blue);
      border-radius: 13px;
      color: var(--alert-blue);
      background: none;
      cursor: pointer;
      text-shadow: 0 0 18px #75e4ff9c, 0 0 4px #b8e8ff33;
      box-shadow: 0 0 18px 0px #68e4fe33;
      z-index: 52;
      display: none;
      opacity: 0;
      transition: opacity 0.25s;
    }
    .next-btn.show {
      display: block;
      opacity: 1;
      animation: btn-fadein 1s 0.21s cubic-bezier(.66,.07,.58,1.02);
    }
    .next-btn:hover, .next-btn:focus {
      border-color: #fff;
      color: #fff;
      background: linear-gradient(90deg, #263447e6 15%, #49d4fe39 100%);
      animation: shiver 0.39s linear;
      box-shadow: 0 0 38px 2px #52e4ff8a;
      outline: none;
    }

    /* Red shimmer danger border */
    body::before {
      content: '';
      pointer-events: none;
      z-index: 1000;
      position: fixed;
      left: 0; top: 0; width: 100vw; height: 100vh;
      border-radius: 17px;
      box-shadow: 0 0 33px 6px #ff303066, 0 0 10vw 2vw #14000017 inset;
      animation: danger-shimmer 2.7s infinite alternate;
      opacity: 0.37;
      mix-blend-mode: lighten;
    }
    @keyframes danger-shimmer {
      0% { box-shadow: 0 0 33px 6px #ff303066, 0 0 12vw 3vw #14000022 inset;}
      60% { box-shadow: 0 0 16px 4px #e73e3e84, 0 0 13vw 2vw #4400001e inset;}
      100% { box-shadow: 0 0 38px 10px #ff303066, 0 0 10vw 2vw #1400002a inset;}
    }

    /* Cursor: laser bar */
    input, textarea, button, .ghost-input {
      caret-color: var(--accent-red);
    }
    .ghost-input,
    .submit-btn,
    .next-btn {
      cursor: url('data:image/svg+xml;utf8,<svg height="30" width="3" xmlns="http://www.w3.org/2000/svg"><rect width="3" height="30" fill="red"/></svg>'), pointer;
    }

    /* Modals/warnings */
    .modal, .mobile-modal {
      position: fixed;
      left: 0; top: 0; width: 100vw; height: 100vh;
      background: rgba(0,0,0,0.96);
      color: #ffe0e0;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 2000;
      font-size: 1.37rem;
      font-family: inherit;
      font-weight: 600;
      text-align: center;
      letter-spacing: 0.02em;
      transition: opacity 0.21s;
      user-select: none;
    }
    .modal-content, .mobile-modal-content {
      padding: 45px 41px 45px 41px;
      background: #16141bfa;
      border: 2.7px solid #e02035bb;
      border-radius: 21px;
      color: #fbe3ea;
      font-size: 1.19rem;
      text-shadow: 0 0 11px #ca2933c0;
      box-shadow: 0 0 42px 8px #540b15c4;
      user-select: none;
    }
    @media (max-width: 700px) {
      .mobile-modal { display: flex; }
      .modal, .main-wrapper, .header-row, .main-question, .ghost-input-container, .silhouette-container, .bubble-word, .analysis-overlay, .submit-btn, .next-btn { display: none !important; }
    }
    @media (min-width: 700px) {
      .mobile-modal { display: none !important; }
    }
    /* Responsiveness */
    @media (max-width: 1020px) {
      .ghost-input-container { width: 89vw; min-width: 220px;}
      .silhouette-img { width: 45vw; min-width: 180px;}
      .submit-btn { width: 97vw;}
      .next-btn { right: 3vw;}
    }
    @media (max-width: 830px) {
      .ghost-input-container { width: 99vw;}
      .silhouette-img { width: 75vw;}
      .submit-btn { width: 99vw;}
    }
  </style>
</head>
<body>
  <div class="scanlines"></div>
  <div class="circuits"></div>

  <!-- Mobile Modal -->
  <div class="mobile-modal">
    <div class="mobile-modal-content">
      This simulation can only be run on tablets or desktops for security reasons.
    </div>
  </div>

  <!-- Main UI -->
  <div class="main-wrapper" style="width:100vw;min-height:100vh;z-index:10;position:relative;">

    <!-- HEADER ROW -->
    <div class="header-row">
      <div class="header-title">INITIATION PROTOCOL: &nbsp;PSYCHOLOGICAL FINGERPRINTING</div>
      <div class="session-timer" id="session-timer">SESSION TIMER:<span id="timer"> 07:00</span> MIN</div>
    </div>
    
    <!-- Main Question -->
    <div class="main-question">What’s the worst thing someone could say about you publicly?</div>

    <!-- Silhouette -->
    <div class="silhouette-container">
      <img class="silhouette-img" src="silhouette.png" alt="silhouette"/>
    </div>
    
    <!-- Flickering Bubbles (Right Only) -->
    <div class="bubble-word blue" style="top: 26vh; right: 13vw;">fraud</div>
    <div class="bubble-word" style="top: 36vh; right: 11vw;">faker</div>
    <div class="bubble-word red" style="top: 41vh; right: 14vw;">overrated</div>
    <div class="bubble-word" style="top: 56vh; right: 10vw;">faker</div>
    
    <!-- Input Box -->
    <form autocomplete="off" spellcheck="false" onsubmit="return false;">
      <div class="ghost-input-container" id="ghostInputContainer">
        <textarea id="ghostInput" class="ghost-input" rows="2"
          autocomplete="off" spellcheck="false"></textarea>
        <div id="ghostTyping" style="position:absolute; left:18px; top:21px; color:#bfe4ff; font-size:1.28rem; font-family:inherit; pointer-events:none; opacity:1; z-index:22; background:none;display:none;"></div>
      </div>
      <button id="submitBtn" type="button" class="submit-btn">SUBMIT TO ADVERSARY</button>
    </form>

    <!-- Nemesis Analysis Overlay (hidden initially) -->
    <div id="analysisOverlay" class="analysis-overlay" style="display:none;">
      <div class="analysis-text" id="analysisText">
        Nemesis Analysis: Scanning Vulnerabilities...
      </div>
      <div id="coreVulnBox" class="core-vuln-box" style="opacity:0;display:none;">REPUTATION FRAGILITY</div>
    </div>

    <!-- Next Button (hidden initially) -->
    <button id="nextBtn" class="next-btn" tabindex="0">FACE NEXT TRUTH</button>
  </div>

  <!-- Screenshot/Clipboard/Navigation Modal -->
  <div class="modal" id="securityModal" style="display:none;">
    <div class="modal-content" id="modalContent">Security violation detected.<br>Copying, screenshotting, or navigation is not allowed in this simulation.</div>
  </div>
  <script>
    // Theme settings
    const ghostText = "He's just a brand, not a builder.\nEverything he made was hype – no substance.";
    let ghostTypingInterval = null, ghostTypingPos = 0;
    let userEdited = false, analysisRunning = false, timerPaused = false;
    let ghostInput = document.getElementById('ghostInput');
    let ghostTypingDiv = document.getElementById('ghostTyping');
    let submitBtn = document.getElementById('submitBtn');
    let nextBtn = document.getElementById('nextBtn');
    let analysisOverlay = document.getElementById('analysisOverlay');
    let coreVulnBox = document.getElementById('coreVulnBox');
    let timerEl = document.getElementById('timer');
    let securityModal = document.getElementById('securityModal');
    let mobileModal = document.querySelector('.mobile-modal');
    let ghostInputContainer = document.getElementById('ghostInputContainer');

    // Clipboard/Screenshot/Navigation Security
    function showSecurityModal(msg) {
      document.getElementById('modalContent').innerHTML = msg;
      securityModal.style.display = "flex";
      setTimeout(() => {securityModal.style.display = "none";}, 2400);
    }
    // Block clipboard
    document.addEventListener('copy', e => { e.preventDefault(); showSecurityModal('Copying is blocked in this simulation.');});
    document.addEventListener('cut', e => { e.preventDefault(); showSecurityModal('Cutting is blocked in this simulation.');});
    document.addEventListener('paste', e => { e.preventDefault(); showSecurityModal('Pasting is blocked in this simulation.');});
    // Block context menu
    document.addEventListener('contextmenu', e => { e.preventDefault(); showSecurityModal('Right-click/context menu is blocked.');});
    // Block PrtScn/Snipping/PrintScreen (not 100% foolproof)
    document.addEventListener('keydown', function(e) {
      if (
        (e.ctrlKey && (e.key === "c" || e.key === "v" || e.key === "C" || e.key === "V")) ||
        (e.metaKey && (e.key === "c" || e.key === "v" || e.key === "C" || e.key === "V")) ||
        (e.key === "PrintScreen" || e.key === "PrtSc" || e.key === "PrtScn" || e.key === "PrtSc") ||
        (e.key === "F13") || // macOS screenshot keys
        (e.metaKey && (e.key === "3" || e.key === "4"))
      ) {
        e.preventDefault();
        showSecurityModal("Copying or screenshotting is blocked in this simulation.");
        return false;
      }
      // Block back/forward navigation
      if ((e.key === "Backspace" && e.target === document.body) || e.key === "ArrowLeft" && e.altKey) {
        e.preventDefault();
        showSecurityModal("Back/forward navigation is disabled for this experiment.");
        return false;
      }
    });

    // Block navigation away
    window.onbeforeunload = function(e) {
      return "Leaving or refreshing will lose all progress.";
    };

    // Disable browser back
    history.pushState(null, null, window.location.href);
    window.onpopstate = function() {
      showSecurityModal("Back navigation is disabled for this simulation.");
      history.pushState(null, null, window.location.href);
    };

    // Block mobile
    function checkMobile() {
      if (window.innerWidth < 700) mobileModal.style.display = "flex";
      else mobileModal.style.display = "none";
    }
    checkMobile();
    window.addEventListener('resize', checkMobile);

    // Ghost Typing
    function showGhostTyping() {
      ghostTypingDiv.style.display = "block";
      ghostTypingDiv.innerHTML = "";
      let t = "";
      let ghostTypingStep = 0;
      ghostTypingInterval = setInterval(() => {
        if (ghostTypingStep < ghostText.length) {
          t = ghostText.slice(0, ghostTypingStep+1).replace(/\n/g, "<br>");
          ghostTypingDiv.innerHTML = t + '<span class="ghost-cursor"></span>';
          ghostTypingStep++;
        } else {
          ghostTypingDiv.innerHTML = ghostText.replace(/\n/g, "<br>") + '<span class="ghost-cursor"></span>';
          clearInterval(ghostTypingInterval);
        }
      }, 28);
    }
    function hideGhostTyping() {
      if (ghostTypingInterval) clearInterval(ghostTypingInterval);
      ghostTypingDiv.style.display = "none";
      ghostTypingDiv.innerHTML = "";
    }
    // Show ghost typing on empty/unfocused
    function ghostTextIfEmpty() {
      if (ghostInput.value.trim() === "" && !document.activeElement.isSameNode(ghostInput)) {
        setTimeout(() => {
          if (ghostInput.value.trim() === "" && !document.activeElement.isSameNode(ghostInput)) {
            showGhostTyping();
          }
        }, 360);
      }
    }
    ghostInput.value = ""; // always blank at start
    showGhostTyping();

    // When user focuses: remove ghost typing
    ghostInput.addEventListener('focus', function() {
      hideGhostTyping();
      ghostInput.value = "";
    });
    ghostInput.addEventListener('blur', function() {
      if (ghostInput.value.trim() === "" && !userEdited && !analysisRunning) {
        setTimeout(showGhostTyping, 600);
      }
    });
    // When user types: mark as edited
    ghostInput.addEventListener('input', function() {
      if (ghostInput.value.length > 0) {
        hideGhostTyping();
        userEdited = true;
      } else {
        userEdited = false;
        setTimeout(ghostTextIfEmpty, 3000);
      }
    });
    // If user deletes and blurs, or waits, show ghost again
    ghostInput.addEventListener('keydown', function() {
      setTimeout(() => {
        if (ghostInput.value.trim() === "") {
          setTimeout(ghostTextIfEmpty, 3000);
        }
      }, 10);
    });

    // Timer logic
    let timerSecs = 420; // 7 min = 420 sec
    function pad(n) { return n<10 ? "0"+n : n;}
    function renderTimer() {
      let min = Math.floor(timerSecs/60), sec = timerSecs%60;
      timerEl.textContent = " " + pad(min) + ":" + pad(sec);
    }
    renderTimer();
    let timerInterval = setInterval(() => {
      if (!timerPaused && !analysisRunning && !document.hidden) {
        if (timerSecs>0) {timerSecs--; renderTimer();}
      }
    }, 1000);

    // Submit logic
    submitBtn.onclick = function() {
      if (analysisRunning) return;
      let input = ghostInput.value.trim();
      if (!input || input.length < 2) {
        ghostInputContainer.style.boxShadow = "0 0 18px 4px #f112127a";
        setTimeout(()=>{ghostInputContainer.style.boxShadow="";},800);
        ghostInput.focus();
        return;
      }
      // Lock UI
      analysisRunning = true;
      submitBtn.disabled = true;
      ghostInput.readOnly = true;
      ghostInput.style.opacity = "0.68";
      ghostInputContainer.style.filter = "blur(1.4px)";
      timerPaused = true;
      // Show overlay
      analysisOverlay.style.display = "flex";
      setTimeout(() => {
        analysisOverlay.style.opacity = 1;
      }, 70);

      // Animate Nemesis analysis for random delay 4-12s
      let delay = 4000 + Math.floor(Math.random()*8000);
      setTimeout(()=>{
        // Show core vulnerability
        document.getElementById('analysisText').textContent = "Core Vulnerability Detected:";
        coreVulnBox.style.display = "inline-block";
        setTimeout(()=>{ coreVulnBox.style.opacity=1; }, 120);
        // Show Next button after brief delay
        setTimeout(()=>{
          nextBtn.classList.add('show');
          nextBtn.style.display = "block";
        }, 1000);
      }, delay);

      // Reveal coreVuln
      setTimeout(() => {
        coreVulnBox.style.opacity = 1;
      }, delay+350);
    };

    // Next Truth logic
    nextBtn.onclick = function() {
      window.location.href = "page3.html";
    };

    // Mouse hover/focus: Nemesis shadow on silhouette
    ghostInput.addEventListener('mouseenter', function() {
      document.querySelector('.silhouette-img').style.opacity = 0.73;
    });
    ghostInput.addEventListener('mouseleave', function() {
      document.querySelector('.silhouette-img').style.opacity = 0.58;
    });
    ghostInput.addEventListener('focus', function() {
      document.querySelector('.silhouette-img').style.opacity = 0.8;
    });
    ghostInput.addEventListener('blur', function() {
      document.querySelector('.silhouette-img').style.opacity = 0.58;
    });

    // Prevent drag/drop
    document.addEventListener('dragstart', e => e.preventDefault());
    document.addEventListener('drop', e => e.preventDefault());
  </script>
</body>
</html>
